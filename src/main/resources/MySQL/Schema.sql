-- MySQL Script generated by MySQL Workbench
-- Sun May 22 01:38:39 2022
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema Private_announcements
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `Private_announcements` ;

-- -----------------------------------------------------
-- Schema Private_announcements
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `Private_announcements` DEFAULT CHARACTER SET utf8 ;
USE `Private_announcements` ;

-- -----------------------------------------------------
-- Table `Private_announcements`.`User`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Private_announcements`.`User` ;

CREATE TABLE IF NOT EXISTS `Private_announcements`.`User` (
  `id_User` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NULL,
  `email` VARCHAR(45) NULL,
  `telephone_Number` VARCHAR(45) NULL,
  `login` VARCHAR(45) NULL,
  `password` VARCHAR(75) NULL,
  PRIMARY KEY (`id_User`),
  UNIQUE INDEX `login_UNIQUE` (`login` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Private_announcements`.`Role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Private_announcements`.`Role` ;

CREATE TABLE IF NOT EXISTS `Private_announcements`.`Role` (
  `id_Role` INT NOT NULL AUTO_INCREMENT,
  `role` VARCHAR(45) NULL,
  PRIMARY KEY (`id_Role`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Private_announcements`.`Announcement`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Private_announcements`.`Announcement` ;

CREATE TABLE IF NOT EXISTS `Private_announcements`.`Announcement` (
  `id_Announcement` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NULL,
  `price` INT NULL,
  `startDate` DATE NULL,
  `soldDate` DATE NULL,
  `description` VARCHAR(455) NULL,
  `vip` TINYINT(1) NULL,
  `sold` TINYINT(1) NULL,
  `user_Id` INT NOT NULL,
  PRIMARY KEY (`id_Announcement`),
  INDEX `userID_idx` (`user_Id` ASC),
  CONSTRAINT `userID`
    FOREIGN KEY (`user_Id`)
    REFERENCES `Private_announcements`.`User` (`id_User`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Private_announcements`.`Comment`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Private_announcements`.`Comment` ;

CREATE TABLE IF NOT EXISTS `Private_announcements`.`Comment` (
  `idComment` INT NOT NULL AUTO_INCREMENT,
  `bodyComment` VARCHAR(500) NULL,
  `Sender` INT NULL,
  `toAnnouncement` INT NULL,
  PRIMARY KEY (`idComment`),
  INDEX `sender_idx` (`Sender` ASC),
  INDEX `toAnnouncement_idx` (`toAnnouncement` ASC),
  CONSTRAINT `senderComment`
    FOREIGN KEY (`Sender`)
    REFERENCES `Private_announcements`.`User` (`id_User`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `toAnnouncement`
    FOREIGN KEY (`toAnnouncement`)
    REFERENCES `Private_announcements`.`Announcement` (`id_Announcement`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Private_announcements`.`Chat`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Private_announcements`.`Chat` ;

CREATE TABLE IF NOT EXISTS `Private_announcements`.`Chat` (
  `idChat` INT NOT NULL AUTO_INCREMENT,
  `chatSender` INT NULL,
  `chatRecipient` INT NULL,
  `message` VARCHAR(500) NULL,
  PRIMARY KEY (`idChat`),
  INDEX `sender_idx` (`chatSender` ASC),
  INDEX `resipient_idx` (`chatRecipient` ASC),
  CONSTRAINT `senderChat`
    FOREIGN KEY (`chatSender`)
    REFERENCES `Private_announcements`.`User` (`id_User`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `resipientChat`
    FOREIGN KEY (`chatRecipient`)
    REFERENCES `Private_announcements`.`User` (`id_User`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Private_announcements`.`User_Role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Private_announcements`.`User_Role` ;

CREATE TABLE IF NOT EXISTS `Private_announcements`.`User_Role` (
  `idUser_Role` INT NOT NULL AUTO_INCREMENT,
  `user` INT NULL,
  `role` INT NOT NULL,
  PRIMARY KEY (`idUser_Role`),
  INDEX `UserRole_idx` (`user` ASC),
  CONSTRAINT `UserRole`
    FOREIGN KEY (`user`)
    REFERENCES `Private_announcements`.`User` (`id_User`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Role`
    FOREIGN KEY (`role`)
    REFERENCES `Private_announcements`.`Role` (`id_Role`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Private_announcements`.`Rating`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Private_announcements`.`Rating` ;

CREATE TABLE IF NOT EXISTS `Private_announcements`.`Rating` (
  `idRating` INT NOT NULL AUTO_INCREMENT,
  `toUser` INT NOT NULL,
  `fromUser` INT NOT NULL,
  `rating` INT NULL,
  INDEX `toUser_idx` (`toUser` ASC),
  INDEX `fromUser_idx` (`fromUser` ASC),
  PRIMARY KEY (`idRating`),
  CONSTRAINT `toUser`
    FOREIGN KEY (`toUser`)
    REFERENCES `Private_announcements`.`User` (`id_User`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fromUser`
    FOREIGN KEY (`fromUser`)
    REFERENCES `Private_announcements`.`User` (`id_User`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `Private_announcements`.`User`
-- -----------------------------------------------------
START TRANSACTION;
USE `Private_announcements`;
INSERT INTO `Private_announcements`.`User` (`id_User`, `name`, `email`, `telephone_Number`, `login`, `password`) VALUES (1, 'Admin', 'email@mail.com', '+3752912345678', 'Admin', '$2a$10$Xgp47yiwVrJGZSqcu6pRUei69ak8okFIFGO1EE2fdk4qNCbB93Bzq');
INSERT INTO `Private_announcements`.`User` (`id_User`, `name`, `email`, `telephone_Number`, `login`, `password`) VALUES (2, 'User_1', 'user_1@mail.com', '+3752912345679', 'User1', '$2a$10$Xgp47yiwVrJGZSqcu6pRUei69ak8okFIFGO1EE2fdk4qNCbB93Bzq');
INSERT INTO `Private_announcements`.`User` (`id_User`, `name`, `email`, `telephone_Number`, `login`, `password`) VALUES (3, 'User_2', 'user_2@mail.com', '+3752912345680', 'User2', '$2a$12$FKekHYTqCdYSzoVZwNB/8OmnRHuHdPS7HHHfXEcEnmVgFXTW/WBh.');
INSERT INTO `Private_announcements`.`User` (`id_User`, `name`, `email`, `telephone_Number`, `login`, `password`) VALUES (4, 'User_3', 'user_3@mail.com', '+3752912345681', 'User3', '$2a$12$FKekHYTqCdYSzoVZwNB/8OmnRHuHdPS7HHHfXEcEnmVgFXTW/WBh.');

COMMIT;


-- -----------------------------------------------------
-- Data for table `Private_announcements`.`Role`
-- -----------------------------------------------------
START TRANSACTION;
USE `Private_announcements`;
INSERT INTO `Private_announcements`.`Role` (`id_Role`, `role`) VALUES (1, 'ADMIN');
INSERT INTO `Private_announcements`.`Role` (`id_Role`, `role`) VALUES (2, 'USER');

COMMIT;


-- -----------------------------------------------------
-- Data for table `Private_announcements`.`Announcement`
-- -----------------------------------------------------
START TRANSACTION;
USE `Private_announcements`;
INSERT INTO `Private_announcements`.`Announcement` (`id_Announcement`, `name`, `price`, `startDate`, `soldDate`, `description`, `vip`, `sold`, `user_Id`) VALUES (1, 'Пылесос BOSCH', 50, '2022-01-20', NULL, 'Почти новый, на гарантии', 0, 0, 2);
INSERT INTO `Private_announcements`.`Announcement` (`id_Announcement`, `name`, `price`, `startDate`, `soldDate`, `description`, `vip`, `sold`, `user_Id`) VALUES (2, 'Телевизор LG', 250, '2022-01-20', '2022-03-01', NULL, 1, 1, 3);
INSERT INTO `Private_announcements`.`Announcement` (`id_Announcement`, `name`, `price`, `startDate`, `soldDate`, `description`, `vip`, `sold`, `user_Id`) VALUES (3, 'Домкрат', 10, '2022-01-20', NULL, NULL, 0, 0, 4);
INSERT INTO `Private_announcements`.`Announcement` (`id_Announcement`, `name`, `price`, `startDate`, `soldDate`, `description`, `vip`, `sold`, `user_Id`) VALUES (4, 'PC', 500, '2022-01-20', NULL, NULL, 0, 0, 4);

COMMIT;


-- -----------------------------------------------------
-- Data for table `Private_announcements`.`Comment`
-- -----------------------------------------------------
START TRANSACTION;
USE `Private_announcements`;
INSERT INTO `Private_announcements`.`Comment` (`idComment`, `bodyComment`, `Sender`, `toAnnouncement`) VALUES (1, NULL, 1, 1);
INSERT INTO `Private_announcements`.`Comment` (`idComment`, `bodyComment`, `Sender`, `toAnnouncement`) VALUES (2, NULL, 2, 2);
INSERT INTO `Private_announcements`.`Comment` (`idComment`, `bodyComment`, `Sender`, `toAnnouncement`) VALUES (3, NULL, 3, 3);
INSERT INTO `Private_announcements`.`Comment` (`idComment`, `bodyComment`, `Sender`, `toAnnouncement`) VALUES (4, NULL, 4, 4);
INSERT INTO `Private_announcements`.`Comment` (`idComment`, `bodyComment`, `Sender`, `toAnnouncement`) VALUES (5, NULL, 1, 1);
INSERT INTO `Private_announcements`.`Comment` (`idComment`, `bodyComment`, `Sender`, `toAnnouncement`) VALUES (6, NULL, 2, 2);
INSERT INTO `Private_announcements`.`Comment` (`idComment`, `bodyComment`, `Sender`, `toAnnouncement`) VALUES (7, NULL, 2, 3);

COMMIT;


-- -----------------------------------------------------
-- Data for table `Private_announcements`.`Chat`
-- -----------------------------------------------------
START TRANSACTION;
USE `Private_announcements`;
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (1, 3, 2, 'Скидку сделаете?');
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (2, 2, 3, 'Нет.');
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (DEFAULT, 1, 2, 'Объявление размещено');
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (DEFAULT, 2, 4, '1');
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (DEFAULT, 3, 1, 'Как изменить пароль?');
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (DEFAULT, 4, 1, 'Можно восстановить пароль? На почту?');
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (DEFAULT, 1, 3, 'Спасибо');
INSERT INTO `Private_announcements`.`Chat` (`idChat`, `chatSender`, `chatRecipient`, `message`) VALUES (DEFAULT, 3, 2, 'Продано');

COMMIT;


-- -----------------------------------------------------
-- Data for table `Private_announcements`.`User_Role`
-- -----------------------------------------------------
START TRANSACTION;
USE `Private_announcements`;
INSERT INTO `Private_announcements`.`User_Role` (`idUser_Role`, `user`, `role`) VALUES (1, 1, 1);
INSERT INTO `Private_announcements`.`User_Role` (`idUser_Role`, `user`, `role`) VALUES (2, 1, 2);
INSERT INTO `Private_announcements`.`User_Role` (`idUser_Role`, `user`, `role`) VALUES (3, 2, 2);
INSERT INTO `Private_announcements`.`User_Role` (`idUser_Role`, `user`, `role`) VALUES (4, 3, 2);
INSERT INTO `Private_announcements`.`User_Role` (`idUser_Role`, `user`, `role`) VALUES (5, 4, 2);

COMMIT;


-- -----------------------------------------------------
-- Data for table `Private_announcements`.`Rating`
-- -----------------------------------------------------
START TRANSACTION;
USE `Private_announcements`;
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (1, 1, 2, 5);
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (2, 2, 4, 4);
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (3, 2, 3, 5);
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (4, 3, 4, 3);
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (5, 3, 2, 2);
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (6, 4, 1, 1);
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (7, 4, 2, 3);
INSERT INTO `Private_announcements`.`Rating` (`idRating`, `toUser`, `fromUser`, `rating`) VALUES (8, 4, 3, 2);

COMMIT;

